# 概要

「Next.js」と「.md」で作成する静的なブログアプリとなります。

「Imageコンポーネント(Next.js)」の変わりに、「sharp」を利用して画像の処理を行いページの軽量化を行っています。
（webp拡張子かつ圧縮した2種類のサイズの画像ファイルを自動生成）

SEOも考慮した設計となっており、H1の見出しタグも「TOPページ：ブログタイトル」「記事ページ：記事タイトル」と、各ページで変更を加えています。

また、内部リンクの集まるカテゴリページもコンテンツの挿入が出来るなど、本格的なブログが作成できます。

実用性を目指して作りはじめた本格ブログです。

## 最新バージョンについて(重要)

機能を足した「.md」「.mdx」に対応した、上位互換のブログアプリを別個作成しています。

blogの運用をすると、記事の装飾のテンプレート（コンポーネントで作成）を利用できるなど、MDX形式のブログの方が良いとなりました。

そのため、このmdブログは形としては出来上がっていますが、更なるブラッシュアップは中止して、

mdxに対応したブログの開発を勧めていますので、そちらをご覧頂ければと思います。

下記URLより「mdxブログ」をご覧頂ければと思います。

GitHub ：https://github.com/haru0354/next-blog-ssg-mdx.git （mdxBlog）

## 特徴

- 記事やカテゴリをmdファイルで管理
- SEOを意識したブログを構築
- 画像をwebpに変換し圧縮（ブログの軽量化）
- 2種類のデザインパターン
- sitemap.xmlは自動で作成

## 主な技術スタック

- TypeScript
- Next.js v14
- React v18
- Tailwind CSS
- gray-matter：Markdown のメタデータ読み込み
- sharp：画像処理

## セットアップ手順

1. リポジトリをクローン：

git clone https://github.com/haru0354/next-blog-ssg-md.git

cd next-blog-ssg-md

2. 依存関係をインストール：

npm install

3. サーバーを起動：

npm run dev

### コマンドの概要

| コマンド        | 説明                                                 |
| --------------- | ---------------------------------------------------- |
| `npm install`   | フロントエンドの依存関係をインストール               |
| `npm run dev`   | フロントエンドのサーバー起動        |
| `npm run image` | public フォルダの画像の圧縮と拡張子を変更（webp へ） |

## SEOを意識したサイト構造

デフォルトのサイト構造を紹介します。

- TOPページ
  - logoがh1タグとなっています。
  - カテゴリタイトルはh3タグとなります。 
  - 記事タイトルはh3タグとなります。 

- 記事ページ
  - logoは見出しタグは付きません。
  - 記事タイトルがh1タグとなります。

- カテゴリページ
  - 関連記事はh2タグとなります。
  - 関連記事内の各個別ページのタイトルはh3タグとなります。

各ページのサイドメニューには見出しタグは付きません。

記事ページのタイトルは「記載した記事タイトル | サイトタイトル」になります。
カテゴリページのタイトルは「記載したカテゴリタイトル | サイトタイトル」になります。

## 画像をwebpに変換し圧縮

publicフォルダに画像を配置すると、圧縮と変換がされた画像が自動生成されます。

「npm run dev」と[npm run build]の実行時に、2種類の画像ファイルの圧縮と変換が行われます。

1. image_webp：80%の品質で圧縮、webpに変換
2. thumbnail_webp：80%の品質で圧縮、width：300px、webpに変換

記事のアイキャッチには「image_webpフォルダ」の画像が配置されます。
TOPページ、関連記事、サイドメニューには「thumbnail_webpフォルダ」の画像が配置されます。

変換をした画像は「scriptsフォルダ」の「ConvertedFileNameList.json」にリスト化。
再度、実行時に照らし合わせて、未変換のファイルのみ変換と圧縮がされる仕様です。

また、専用の画像変換コマンドの「npm run image」でも実行がされるようになっています。

詳しくはscriptsフォルダにある「ConvertToWebp.js」をご覧ください。

## 作成時に変更する箇所

- 画像
  - ロゴ画像(logo.png)
  - ファビコン(favicon.ico)
- テキスト
  - フッターのサイト名
  - ロゴ画像の alt
- meta タグ
  - TOP ページ用の meta タグ(サイトタイトルと説明文)
    カテゴリ・個別記事のタイトルは「記事タイトル ｜ サイトタイトル」になるよう設定されています。
    プライバシーポリシーページは description は TOP ページと同じのが設定されています。
- sitemap.xml
  - サイトのURLを変更

## カテゴリの作成手順

1. mdFile ディレクトリの「categorySample」をコピー
2. mdFile > category ディレクトリへコピーしたサンプルファイルを入れる。
3. ファイル名を変更する(slugになる)。
4. 各項目を変更をする。

### カテゴリの補足

カテゴリページは単なるリスト表示ではなく、コンテンツを表示するように作成しています。
下部はカテゴリ内の記事が一覧が表示されるようにしています。

上記仕様の理由としてはSEOとユーザービリティーを考慮しています。

簡単に説明するとカテゴリページは内部リンクが集まりやすいページだからです。
また、サイト構造を考えても上記仕様が適していると思います。

categoryName: カテゴリ名を記載
title: カテゴリのタイトル(記事タイトルと同じ)

カテゴリページのslugはファイル名が適用されます。

## 記事の作成手順

1. mdFile ディレクトリの「articleSample」をコピー
2. mdFile > article ディレクトリへコピーしたサンプルファイルを入れる。
3. ファイル名を変更する(slugになる)。
4. 各項目を変更をする。

### 記事の補足

categorySlug: カテゴリのスラッグ名を入力してください。

上記の項目はsitemap.xmlを作成するのに必要な項目となっています。

## 追加できるメニュー

記載をすることで様々なメニューを追加できるようになっています。

- グローバルメニュー(globalMenu.md)
- サイドバーのおすすめの記事(recommendArticle.md)
- サイドバーのリンク(参考文献・参考サイト)(link.md)

それぞれのファイルはmdFileディレクトリのmenuディレクトリの中にあります。
各ファイルの１つ目を記載すると、各メニューが表示されるようになります。

## デザインの変更

- パターン2への変更(ブロック型)
  - SideMenu.tsxの「bg-white」を外す
  - コンポーネント > sideMenu 内のコンポーネントをSideCategory2とSideNewArticle2に変更。
  - (blog) > [category_slug]の１つ目のdivタグに「border border-gray-200」を追加
  - (blog) > [category_slug] > [article_slug]の１つ目のdivタグに「border border-gray-200」を追加

個人的にはデザインパターン2へ変更するなら統一して全てのコンポーネントを変えた方が良いと思います。
ただ、組み合わせはできるのでご自由に変更が可能です。

- カテゴリの関連記事の変更
  - (blog) > [category_slug] 最下部の(CategoryInArticlesList)コンポーネントを変更

1. 画像2枚が横並び(CategoryInArticlesList2Images)
2. 左に画像、右にタイトルと説明文(CategoryInArticlesList)

(blog) > [category_slug]

